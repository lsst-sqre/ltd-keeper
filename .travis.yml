sudo: required
services:
  - docker
language: python
matrix:
  include:
    # This is the ltd-mason documentation deployment build
    - python: "3.6"
      env: LTD_MASON_BUILD=true DEPLOY_DOCKER_IMAGE=true
install:
  - "make install"
  - "pip install ltd-mason==0.2.2"
script:
  - "make test"
  - "make docs"
  - "make image"
after_success:
  # ltd-mason (no-op for regular builds with LTD_MASON_BUILD=false)
  - ltd-mason-travis --html-dir docs/_build/html --verbose
  # Docker Hub (no-op for PRs and DEPLOY_DOCKER_IMAGE=false)
  - make travis-docker-deploy
env:
  global:
    - LTD_MASON_BUILD=false  # disable builds in regular text matrix
    - DEPLOY_DOCKER_IMAGE=false  # disable docker push in regular test matrix
    - LTD_MASON_PRODUCT="ltd-keeper"
    # travis encrypt "LTD_MASON_AWS_ID=... LTD_MASON_AWS_SECRET=...
    - secure: "QoOaiKnEkCsjpBO5bB//pJP8RdbL/6oddNRUae6xmWmDq+ntdHUQBg3fvsYh5zcqkH8IfBSr+hVBgMd+nps3qVyV/HkKGwKBAMFk8nKqTDNUAfozBQtjBYDqxzP0ig8h4Qu+nmKIhGOVzFtkH6yiK42lbI5m6sXDRo8WwR6fvGqTX+2gtFY5daVZzxmtsKJ0bV0R2qkflE6TrGMi02Qj3liDZo4AU+MfqajHF2Egfi8wbAMyUJVGIFtGA9KiN5PbNR0eAFRMpLr98KO5/Vw0uMVElDif9oYHteqGwC9slxYu/rdIirpqmCxjAFvdVUTe3mk8/jUq9ANcGIAyBe5xbfkYCAv8n6UDTPj7IBcVF/DtYgbcB+n4t8zRk1t+4IOmF1RMG7E2g0nbQoS0VwOd9t1ZsUJSJIm2buTwA395KgJfJZQUQm+gY66/BA2WckxUuOgzYRzLVj3x9rWcKje+4MIA60ZqCiWGq2AFcFmr+ULqQOSQk8TcfGLl3iL1S6RfoDmy0AFtFXVthLHU/EER5Au0ukC1DitKrHve+Bq3qR2pXGPCdrwlCDde6qmarMWkf893zXjHpgNyaZ+3tqUOOkf4842w/688g5B6mMtRqsCylHn9b4GJM8J8XCeBKU5QDU/BHZbafnanbP8A6jvlYaISaiG5JJBwjikZCu+BiFc="
    # travis encrypt "LTD_KEEPER_URL=... LTD_KEEPER_USER=... LTD_KEEPER_PASSWORD=..." --add env.global
    - secure: "Fz0VPGtPIWG4D9GcW88ZwXucDJwx2HFnRidEOraZx1e3NBzd4rE5UoEOgCB68MQlKLozlDD9RnBGuV/d2+PbB6tczMBugVlptApP2Wd0BA8JOqnsAgaRuB2Fw+euuRUoaN+NGPta3MS5v44gvto25WNnkU8yGFiiGbH/KAZT3MH2pm7Fa7BnFexvAyXRY33klXRHZ5wLH+e/RrMwsqk9aqiF0JFn5iS+XP32imBdkgVnJDOwp6ptLTYXQdQ7pm5zjNi3M6EA/bIOMsyG3kwWU8WkXuZSThrseYD4UnSEooQHZhowNklZ2V69iUo3t5QhbU7NelMcxJSThK39EuIW95ayYUl8t71c9G97LIK8yEOvAJN80jVPvAHrhv/9c5P6GykzwVDECTVZqOxT7YoO5mmXgpfsZmSy2cxsv/mZys3pEbl83//EYc/kDWrV6yIZogchkxYF3V4A3SHURilG8WwqQP/zOrEXdiYbR0lVdcydepywOacqdqH5YfhkC7Q56Eb2tfvtbqgPedmFROTWzNRQGjBibfnCt9mRFeAblXnFco8wOMKbdN4laApXrbdSyJ3aSuzFUuGVe+4OltAer49xOa927DUUePm3QOQfFy+m6gFVt1Ee3f4kWID1LIfu86Vq56KD1U0VBwRPSMCeQdwR/xJ+y8yCbR/Y4IhVXEg="
    # travis encrypt "LTD_KEEPER_TEST_AWS_SECRET=.. LTD_KEEPER_TEST_BUCKET=..." --add env.global
    - secure: PSQOOZHuhu3FpNNhRfZLJJN4juKeodqLcCwEiUlPqLar0uMWtmYivqMZCZCacVWtMxslhr5xuxiHQGzLGZHqFuM4KXjtbYoOc91FEVoQZdSxkRIym/udTMOxFmN/MyJh0U8lDCzBdUq5NOSIuWpIo3TRcWwPcSRs2K/oRoJOjiCxlopIqQOLhzNdfn+DJGQwI54SYVAf73AtmAXPS6WW024U+pb3lmw/oLwXmKGWuve2zK+DoRyJ8c7+IEKp34g50v8iwxIW5v/2Hg2TVG6GVTlsrM65/sGqSLla3xzFwt4a0f7E4VirYMmTomzGy8Pvytk3RYuILk7MYsy6nLXnIxtnL4g4Aapy6QlB/d4niRQAIZkHmYR9hkXTe0k63ZYwrODLVMQ459yR+/8+JgbxefAqquLnO2vsBUkOfUYREf8biQupf7aNxpK+Fu4VI21gsUflV0jEyak+7AFKRbrREua9XjG3KG4zPSe4ug4VVK/TCOzWQ8EBB8B+59ZzWcotHJt5KwNUZ5voHe0h0DoF+DmPkuhnQBJiACLyq2jjuzACJpmV9iVBcKyo+157TOJWxsxzOscD7r2fWyc0xJGv2NscCoFjK6+w1aH+J1YVqOE82xeLK31ULwFc5xs975Q5kCdbY+RT7LA8sRSx2BP38SyF5289gfy3KF0fy/zWYWA=
    - LTD_KEEPER_TEST_AWS_ID=AKIAJQTXPK2NYX2KHS7Q
    # Docker username
    - secure: "isvq7HXmPTXl5gFCO3KJK7g1lOIp7eDvdJEC2j4uPyS7IOGGt7E4GhZPrZl0rBKudZY7CINUWZD4EQi2QQTRB2c4xLUIUOAstDXr09VlSCKLRX1+jQeqBI70ZegP9RlMPt+WSfPVjIFh8qZXbne+F9gGZipnkz5M2uG4qzBu5+ZUd+RX2ObOHODWAenmEVW7H7qgzOYLmqdqr5huGhWank42JJpcYxCQ+VeBhlyOWI1oxhBD8LS3PZ+FqFNhux+PeP6CgN+xmiAEd61ei4NeMooe6KNIdesMkXMhRDSaQzRWktOUz0HCOgywf3+aHVtCXB6/JWTCclxLfi1lULGARcy/pMujr/+I/65MFe+U23rDfWS9ww+2tKC1388LiOQeGZhJTE+pLRxASzvGKKI7Nsd8QN4y8UTDjTNwUGfQlFSRIXIG0A9Mam/jt9qlaabI6VF13Muu/I9M+iG+3ARMJknl7ozR6QcO6nixam/Y/3Hc5296vI9EJf6pGqsf0I0xa2jK9YEEdnvBpMWMje4Z48iPaGtslzrsPL+H5rVmQd4JHuK1/Zq+PVJk+U4ted4Gj/s0qz2xhFbrKOBREYQj4y/XQ8Y3nsGMcGDgYQuXTJvldpGltkW2aO6a7Vtr3hcgpwVhXdR16RF8oOY5d9cANyU794w+luXHMvez2fTxd78="
    # Docker password
    - secure: "Q3CGkKIrLb8V0p4wjjW9Naec/V1518lm2FuALHWDt9Zj6hFPxu829p2sBfWw4j6xveC/BjZBlj3qs94roUUN8b99UjZH7swj5jHjZ4e03Aj8SQZT2YHY1kz6NQ9ljPDAqSSGANXZcOfKmbKdcx+87rKvEznsoeATaMaIdY1yL6fXaPr7Sp0eXmJZPEvwfTMHUn7Ggmnlr6PIZ3YgnwHJwrZO9OT/HK4gsvbxGDgdgIxptxx9buKQnC+cMlJd6KcJ59Tafb1R77fHQTmDP27ZuLGVCX+a4pgOVTWq45mAkIL9XZNwdDvPXR8lNkRnw1Q/om5KteZ3RgTCWX4JYo06VP7y2p2H+YB0zeHvpLR61I/qHLApxefqUdR68dKqJPaihGtjKfxyGeNjwFfH4cxyHO/KSsM/KVfX1fB539PTUT8XcBPwcRlF6pOFBfIhx6reB+DoLz34nHvOwgzgfUfbD2s3671qNW4HVk+VHDYoaeojs6eNJvSsGNn/xWzXLTAxzQ6FO89I7tPlr1MWNrlMpVCQh7OiMmXIAfSxQ1KjmN0e6k9DkpByNsz4B+KWkHiCKhTRktBhpbwjYWIuvs1Mg8Cv1OqxCUpPOnJ1prNiuqlSPsoLyTtQjh+bQYF10PlYpy8bVBoyw6WIqhmGU6YMhWtUsBFuzsr7fcfVWqaeqDA="
